!function(){"use strict";let e=new class{constructor(){this.gmarkers=[],this.cur=0,this.dcur=0,this.directionsDisplay=[],this.directionsService=[],this.placeMarkers=[],this.jplace={location:"",radius:3e4,types:[]},this.place_types=[["university","Universities","الجامعات"],["grocery_or_supermarket","Supermarkets","السوبر ماركت"],["park","Parks","الحدائق"],["restaurant","Restaurants","المطاعم"],["shopping_mall","Shopping malls","مراكز التسوق"],["school","Schools","مدارس"]],this.initMap=()=>{var t,i,s;this.mapElement=document.querySelector("#map-canvas");let a=null===(t=this.mapElement)||void 0===t?void 0:t.getAttribute("data-map");if(!a)return;a=JSON.parse(a);let r=null===(i=this.mapElement)||void 0===i?void 0:i.getAttribute("data-settings");r=JSON.parse(r);let n=document.querySelector("#map-cont");if((null===(s=r.height)||void 0===s?void 0:s.indexOf("%"))>0){let e=r.height.replace("%","");var o=window.innerHeight;let t=document.querySelector("#masthead");n.style.height=o-t.clientHeight*e/100+"px",window.addEventListener("resize",(()=>{n.style.height=o-t.clientHeight*e/100+"px"}))}this.mapIsReady=!0;if(void 0!==a.markers&&null!=a.markers&&a.markers.length){var l=a.map;l.styles=[{featureType:"all",stylers:[{saturation:0},{hue:"#e7ecf0"}]},{featureType:"road",stylers:[{saturation:-70}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{visibility:"simplified"},{saturation:-60}]}];let t=document.querySelector("#cont-place-list"),i=null;this.map=new google.maps.Map(document.getElementById("map-canvas"),l),t&&r.allow_places&&this.place_types.forEach((e=>{let s=document.createElement("li"),r=document.createElement("a");r.href="#",r.setAttribute("loc",e[0]+":"+a.markers[0].lat+","+a.markers[0].lng),r.innerHTML="rtl"==NATHEME_MAP.dir?e[2]:e[1],r.addEventListener("click",(e=>{e.preventDefault();var t=r.getAttribute("loc").split(":");if(this.removePlaceMarkers(),2==t.length){var s=new google.maps.places.PlacesService(this.map),a=this.jplace,n=t[1].split(",");a.location=new google.maps.LatLng(n[0],n[1]),a.types=[t[0]],s.nearbySearch(a,this.listPlaces.bind(this))}i&&i.classList.remove("active"),r.classList.add("active"),i=r})),s.appendChild(r),t.appendChild(s)}));let s=document.querySelectorAll("#cont-place li>span");s&&[].forEach.call(s,(e=>{var t;return null===(t=e.parentElement)||void 0===t||t.classList.toggle("gm-show-active"),!1}));for(var c={url:NATHEME_MAP.icon,scaledSize:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},p=0;p<a.markers.length;p++){var m=new google.maps.Marker({position:new google.maps.LatLng(a.markers[p].lat,a.markers[p].lng),map:this.map,animation:google.maps.Animation.DROP,title:a.markers[p].title,label:a.markers[p].label,callback:a.markers[p].callback,icon:c});m.infowindow=new google.maps.InfoWindow({content:a.markers[p].info}),this.gmarkers.push(m),void 0!==a.markers[p].oinfo&&m.infowindow.open(e,m),google.maps.event.addListener(m,"click",(function(t){null!=this.getAnimation()?this.setAnimation(null):(this.setAnimation(google.maps.Animation.BOUNCE),setTimeout((()=>{this.setAnimation(null)}),1e3)),this.callback?this.callback(this):this.infowindow.open(e,this)}))}this.map&&setTimeout((()=>{this.map.setCenter(new google.maps.LatLng(a.markers[0].lat,a.markers[0].lng))}),500)}else console.warn("Please add at least one marker");if(void 0!==a.routes&&null!=a.routes)for(p=0;p<a.routes.length;p++){var d=a.routes[p].orig.split(","),g=new google.maps.LatLng(d[0],d[1]);d=a.routes[p].dest.split(",");var h=new google.maps.LatLng(d[0],d[1]);this.calcRoute(g,h,"DRIVING",{strokeColor:a.routes[p].col})}},document.body.addEventListener("map",(function(e){this.initMap()}))}observeDOM(){var e=window.MutationObserver||window.WebKitMutationObserver;return function(t,i){if(t&&1===t.nodeType){if(e){var s=new e(i);return s.observe(t,{childList:!0,subtree:!0}),s}window.addEventListener&&(t.addEventListener("DOMNodeInserted",i,!1),t.addEventListener("DOMNodeRemoved",i,!1))}}}listPlaces(t,i){if(i==google.maps.places.PlacesServiceStatus.OK&&null!=e)for(var s=0;s<t.length;s++){var a=t[s];this.createPlaceMarker(a)}}createPlaceMarker(t){var i={url:t.icon,scaledSize:new google.maps.Size(16,16),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(0,0)},s=new google.maps.Marker({map:this.map,position:t.geometry.location,title:t.name,icon:i});this.placeMarkers.push(s);const a=new google.maps.InfoWindow({content:""});google.maps.event.addListener(s,"click",(function(){t.photos?a.setContent('<div style="text-align:left"><b>'+t.name+"</b><br/>"+t.vicinity+"</div>"):a.setContent("<b>"+t.name+"</b><br/>"+t.vicinity),a.open(e,this)}))}removePlaceMarkers(){for(var e=0;e<this.placeMarkers.length;e++)this.placeMarkers[e].setMap(null);this.placeMarkers=[]}calcRoute(t,i,s,a){this.directionsService[this.dcur]=new google.maps.DirectionsService;var r={origin:t,destination:i,travelMode:google.maps.TravelMode[s]};this.directionsService[this.dcur].route(r,((t,i)=>{i==google.maps.DirectionsStatus.OK&&(this.directionsDisplay[this.cur]=new google.maps.DirectionsRenderer,this.directionsDisplay[this.cur].setOptions({polylineOptions:a,suppressMarkers:!0}),this.directionsDisplay[this.cur].setMap(e),this.directionsDisplay[this.cur].setDirections(t),this.cur++)})),this.dcur++}};window.initMap=e.initMap}();
